/* Generated by Opal 1.0.3 */
(function(Opal) {
  function $rb_le(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);
  }
  function $rb_divide(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs / rhs : lhs['$/'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_ge(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.const_get_qualified, $$ = Opal.const_get_relative, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$setPrefixes', '$upcase', '$===', '$last_match', '$getAttackResult', '$getCriticalResult', '$==', '$<=', '$floor', '$/', '$-', '$=~', '$to_i', '$>', '$<', '$roll', '$*', '$[]', '$+', '$>=', '$debug', '$!=', '$each', '$get_wh_atpos_message', '$step', '$length', '$check_1D100', '$%', '$wh_atpos']);
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Warhammer');

    var $nesting = [self].concat($parent_nesting), $Warhammer_initialize$1, $Warhammer_rollDiceCommand$2, $Warhammer_check_1D100$3, $Warhammer_getCriticalResult$4, $Warhammer_wh_atpos$5, $Warhammer_get_wh_atpos_message$7, $Warhammer_getAttackResult$9;

    
    Opal.const_set($nesting[0], 'ID', "Warhammer");
    Opal.const_set($nesting[0], 'NAME', "\u30A6\u30A9\u30FC\u30CF\u30F3\u30DE\u30FC");
    Opal.const_set($nesting[0], 'SORT_KEY', "\u3046\u304A\u304A\u306F\u3093\u307E\u3042");
    Opal.const_set($nesting[0], 'HELP_MESSAGE', "" + "\u30FB\u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u8868(whHxx/whAxx/whBxx/whLxx)\n" + "\u3000\"WH\u90E8\u4F4D \u30AF\u30EA\u30C6\u30A3\u30AB\u30EB\u5024\"\u306E\u5F62\u3067\u6307\u5B9A\u3057\u307E\u3059\u3002\u90E8\u4F4D\u306F\u300CH(\u982D\u90E8)\u300D\u300CA(\u8155)\u300D\u300CB(\u80F4\u4F53)\u300D\u300CL(\u8DB3)\u300D\u306E\uFF14\u30AB\u6240\u3067\u3059\u3002\n" + "\u3000\u4F8B\uFF09whH10 whA5 WHL4\n" + "\u30FB\u547D\u4E2D\u5224\u5B9A(WHx@t)\n" + "\u3000\"WH(\u547D\u4E2D\u5024)@(\u7A2E\u5225)\"\u306E\u5F62\u3067\u6307\u5B9A\u3057\u307E\u3059\u3002\n" + "\u3000\u7A2E\u5225\u306F\u811A\u306E\u6570\u3092\u6570\u5B57\u3001\u7FFC\u304C\u4ED8\u3044\u3066\u3044\u308B\u3082\u306E\u306F\u300CW\u300D\u3001\u624B\u304C\u4ED8\u3044\u3066\u3044\u308B\u3082\u306E\u306F\u300CH\u300D\u3067\u66F8\u304D\u307E\u3059\u3002\n" + "\u3000\u300C2H(\u4E8C\u8DB3)\u300D\u300C2W(\u6709\u7FFC\u4E8C\u8DB3)\u300D\u300C4(\u56DB\u8DB3)\u300D\u300C4H(\u534A\u4EBA\u56DB\u8DB3)\u300D\u300C4W(\u6709\u7FFC\u56DB\u8DB3)\u300D\u300CW(\u9CE5\u985E)\u300D\u3068\u306A\u308A\u307E\u3059\u3002\n" + "\u3000\u547D\u4E2D\u5224\u5B9A\u3092\u884C\u3063\u3066\u3001\u5F53\u305F\u308C\u3070\u90E8\u4F4D\u3082\u8868\u793A\u3057\u307E\u3059\u3002\n" + "\u3000\u306A\u304A\u3001\u7A2E\u5225\u6307\u5B9A\u3092\u7701\u7565\u3059\u308B\u3068\u300C\u4E8C\u8DB3\u300D\u3001\u300C@\u300D\u3060\u3051\u306B\u3059\u308B\u3068\u5168\u7A2E\u5225\u306E\u547D\u4E2D\u90E8\u4F4D\u3092\u8868\u793A\u3057\u307E\u3059\u3002(\u30B3\u30DE\u30F3\u30C9\u3092\u5FD8\u308C\u305F\u6642\u306E\u5BFE\u5FDC\u3067\u3059)\n" + "\u3000\u4F8B\uFF09wh60\u3000\u3000wh43@4W\u3000\u3000WH65@\n");
    self.$setPrefixes(["WH.*"]);
    
    Opal.def(self, '$initialize', $Warhammer_initialize$1 = function $$initialize() {
      var $iter = $Warhammer_initialize$1.$$p, $yield = $iter || nil, self = this, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      if ($iter) $Warhammer_initialize$1.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      $send(self, Opal.find_super_dispatcher(self, 'initialize', $Warhammer_initialize$1, false), $zuper, $iter);
      self.sendMode = 2;
      return (self.fractionType = "roundUp");
    }, $Warhammer_initialize$1.$$arity = 0);
    
    Opal.def(self, '$rollDiceCommand', $Warhammer_rollDiceCommand$2 = function $$rollDiceCommand(command) {
      var self = this, output_msg = nil, $case = nil, attackCommand = nil, criticalCommand = nil;

      
      output_msg = nil;
      $case = command.$upcase();
      if (/^(WH\d+(@[\dWH]*)?)/i['$===']($case)) {
      attackCommand = $$($nesting, 'Regexp').$last_match(1);
      output_msg = self.$getAttackResult(attackCommand);}
      else if (/^(WH[HABTLW]\d+)/i['$===']($case)) {
      criticalCommand = $$($nesting, 'Regexp').$last_match(1);
      output_msg = self.$getCriticalResult(criticalCommand);};
      return output_msg;
    }, $Warhammer_rollDiceCommand$2.$$arity = 1);
    
    Opal.def(self, '$check_1D100', $Warhammer_check_1D100$3 = function $$check_1D100(total, _dice_total, cmp_op, target) {
      var self = this;

      
      if (cmp_op['$==']("<=")) {
      } else {
        return ""
      };
      if ($truthy($rb_le(total, target))) {
        return "" + " \uFF1E \u6210\u529F(\u6210\u529F\u5EA6" + ($rb_divide($rb_minus(target, total), 10).$floor()) + ")"
      } else {
        return "" + " \uFF1E \u5931\u6557(\u5931\u6557\u5EA6" + ($rb_divide($rb_minus(total, target), 10).$floor()) + ")"
      };
    }, $Warhammer_check_1D100$3.$$arity = 4);
    
    Opal.def(self, '$getCriticalResult', $Warhammer_getCriticalResult$4 = function $$getCriticalResult(string) {
      var $a, $b, self = this, whh = nil, wha = nil, whb = nil, whl = nil, whw = nil, criticalTable = nil, output = nil, partsWord = nil, criticalValue = nil, whpp = nil, whppp = nil, $case = nil, dice_now = nil, crit_no = nil, crit_num = nil, resultText = nil;

      
      whh = ["01:\u6253\u6483\u3067\u72B6\u6CC1\u304C\u628A\u63E1\u51FA\u6765\u306A\u304F\u306A\u308B\u3002\u6B21\u30BF\u30FC\u30F3\u306F1\u56DE\u306E\u534A\u30A2\u30AF\u30B7\u30E7\u30F3\u3057\u304B\u884C\u306A\u3048\u306A\u3044\u3002", "02:\u8033\u3092\u5F37\u6253\u3055\u308C\u305F\u70BA\u3001\u8033\u9CF4\u308A\u304C\u9177\u304F\u76EE\u7729\u304C\u3059\u308B\u30021R\u306B\u6E21\u3063\u3066\u4E00\u5207\u306E\u30A2\u30AF\u30B7\u30E7\u30F3\u3092\u884C\u306A\u3048\u306A\u3044\u3002", "03:\u6253\u6483\u304C\u982D\u76AE\u3092\u9177\u304F\u50B7\u3064\u3051\u305F\u3002\u3010\u6B66\u5668\u6280\u8853\u5EA6\u3011\u306B-10%\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u7D99\u7D9A\u3002", "04:\u93A7\u304C\u640D\u50B7\u3057\u5F53\u8A72\u90E8\u4F4D\u306EAP-1\u3002\u4FEE\u7406\u3059\u308B\u306B\u306F(\u8077\u80FD:\u93A7\u935B\u51B6)\u30C6\u30B9\u30C8\u3002\u93A7\u3092\u7740\u3051\u3066\u3044\u306A\u3044\u306A\u30891R\u306E\u9593\u30A2\u30AF\u30B7\u30E7\u30F3\u3092\u884C\u306A\u3048\u306A\u3044\u3002", "05:\u8EE2\u3093\u3067\u5012\u308C\u3001\u982D\u304C\u304F\u3089\u304F\u3089\u3059\u308B\u30021R\u306B\u6E21\u3063\u3066\u3042\u3089\u3086\u308B\u30C6\u30B9\u30C8\u306B-30\u3067\u3001\u7ACB\u3061\u4E0A\u304C\u308B\u306B\u306F\u8D77\u7ACB\u30A2\u30AF\u30B7\u30E7\u30F3\u304C\u5FC5\u8981\u3002", "06:1d10R\u6C17\u7D76\u3002", "07:1d10\u5206\u6C17\u7D76\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3002", "08:\u9854\u304C\u305A\u305F\u305A\u305F\u306B\u306A\u3063\u3066\u5012\u308C\u3001\u4EE5\u5F8C\u7121\u9632\u5099\u72B6\u614B\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u3010\u9811\u5F37\u3011\u30C6\u30B9\u30C8\u306B\u5931\u6557\u3059\u308B\u3068\u7247\u65B9\u306E\u8996\u529B\u3092\u5931\u3046\u3002", "09:\u51C4\u307E\u3058\u3044\u6253\u6483\u306B\u3088\u308A\u982D\u84CB\u9AA8\u304C\u7C89\u7815\u3055\u308C\u308B\u3002\u6B7B\u306F\u77AC\u6642\u306B\u8A2A\u308C\u308B\u3002", "10:\u6B7B\u4EA1\u3059\u308B\u3002\u3044\u304B\u306B\u76DB\u5927\u306B\u51FA\u8840\u3057\u3001\u3069\u306E\u3088\u3046\u306A\u6B7B\u306B\u69D8\u3092\u898B\u305B\u305F\u306E\u304B\u3092\u8AAC\u660E\u3057\u3066\u3082\u3088\u3044\u3002"];
      wha = ["01:\u624B\u306B\u63E1\u3063\u3066\u3044\u305F\u3082\u306E\u3092\u843D\u3068\u3059\u3002\u76FE\u306F\u304F\u304F\u308A\u3064\u3051\u3089\u308C\u3066\u3044\u308B\u70BA\u3001\u5F71\u97FF\u306A\u3057\u3002", "02:\u6253\u6483\u3067\u8155\u304C\u75FA\u308C\u30011R\u306E\u9593\u4F7F\u3048\u306A\u304F\u306A\u308B\u3002", "03:\u624B\u306E\u6A5F\u80FD\u304C\u5931\u308F\u308C\u3001\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u56DE\u5FA9\u3067\u304D\u306A\u3044\u3002\u624B\u3067\u63E1\u3063\u3066\u3044\u305F\u3082\u306E(\u76FE\u3092\u9664\u304F)\u306F\u843D\u3061\u308B\u3002", "04:\u93A7\u304C\u640D\u50B7\u3059\u308B\u3002\u5F53\u8A72\u90E8\u4F4D\u306EAP-1\u3002\u4FEE\u7406\u3059\u308B\u306B\u306F(\u8077\u80FD:\u93A7\u935B\u51B6)\u30C6\u30B9\u30C8\u3002\u93A7\u3092\u7740\u3051\u3066\u3044\u306A\u3044\u306A\u3089\u8155\u304C\u75FA\u308C\u30011R\u306E\u9593\u4F7F\u3048\u306A\u304F\u306A\u308B\u3002", "05:\u8155\u306E\u6A5F\u80FD\u304C\u5931\u308F\u308C\u3001\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u56DE\u5FA9\u3067\u304D\u306A\u3044\u3002\u624B\u3067\u63E1\u3063\u3066\u3044\u305F\u3082\u306E(\u76FE\u3092\u9664\u304F)\u306F\u843D\u3061\u308B\u3002", "06:\u8155\u304C\u7815\u304B\u308C\u308B\u3002\u624B\u3067\u63E1\u3063\u3066\u3044\u305F\u3082\u306E(\u76FE\u3092\u9664\u304F)\u306F\u843D\u3061\u308B\u3002\u51FA\u8840\u304C\u3072\u3069\u304F\u3001\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002", "07:\u624B\u9996\u304B\u3089\u5148\u304C\u8840\u307E\u307F\u308C\u306E\u6B8B\u9AB8\u3068\u5316\u3059\u3002\u624B\u3067\u63E1\u3063\u3066\u3044\u305F\u3082\u306E(\u76FE\u3092\u9664\u304F)\u306F\u843D\u3061\u308B\u3002\u51FA\u8840\u304C\u3072\u3069\u304F\u3001\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u3010\u9811\u5065\u3011\u30C6\u30B9\u30C8\u306B\u5931\u6557\u3059\u308B\u3068\u624B\u306E\u6A5F\u80FD\u3092\u5931\u3046\u3002", "08:\u8155\u306F\u8840\u307E\u307F\u308C\u306E\u8089\u584A\u304C\u3076\u3089\u4E0B\u304C\u3063\u3066\u3044\u308B\u72B6\u614B\u306B\u306A\u308B\u3002\u624B\u3067\u63E1\u3063\u3066\u3044\u305F\u3082\u306E(\u76FE\u3092\u9664\u304F)\u306F\u843D\u3061\u308B\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u3010\u9811\u5065\u3011\u30C6\u30B9\u30C8\u306B\u5931\u6557\u3059\u308B\u3068\u8098\u304B\u3089\u5148\u306E\u6A5F\u80FD\u3092\u5931\u3046\u3002", "09:\u5927\u52D5\u8108\u306B\u50B7\u304C\u53CA\u3093\u3060\u3002\u30B3\u30F3\u30DE\u6570\u79D2\u306E\u5185\u306B\u640D\u50B7\u3057\u305F\u80A9\u304B\u3089\u8840\u3092\u5674\u51FA\u3057\u3066\u5012\u308C\u308B\u3002\u30B7\u30E7\u30C3\u30AF\u3068\u5931\u8840\u306B\u3088\u308A\u3001\u307B\u307C\u5373\u6B7B\u3059\u308B\u3002", "10:\u6B7B\u4EA1\u3059\u308B\u3002\u3044\u304B\u306B\u76DB\u5927\u306B\u51FA\u8840\u3057\u3001\u3069\u306E\u3088\u3046\u306A\u6B7B\u306B\u69D8\u3092\u898B\u305B\u305F\u306E\u304B\u3092\u8AAC\u660E\u3057\u3066\u3082\u3088\u3044\u3002"];
      whb = ["01:\u6253\u6483\u3067\u606F\u304C\u8A70\u307E\u308B\u30021R\u306E\u9593\u3001\u30AD\u30E3\u30E9\u30AF\u30BF\u30FC\u306E\u5168\u3066\u306E\u30C6\u30B9\u30C8\u3084\u653B\u6483\u306B-20%\u3002", "02:\u80A1\u9593\u3078\u306E\u4E00\u6483\u3002\u82E6\u75DB\u306E\u3042\u307E\u308A\u30011R\u306B\u6E21\u3063\u3066\u4E00\u5207\u306E\u30A2\u30AF\u30B7\u30E7\u30F3\u3092\u884C\u306A\u3048\u306A\u3044\u3002", "03:\u6253\u6483\u3067\u808B\u9AA8\u304C\u3050\u3061\u3083\u3050\u3061\u3083\u306B\u306A\u308B\u3002\u4EE5\u5F8C\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u306E\u9593\u3001\u3010\u6B66\u5668\u6280\u8853\u5EA6\u3011\u306B-10%\u3002", "04:\u93A7\u304C\u640D\u50B7\u3059\u308B\u3002\u5F53\u8A72\u90E8\u4F4D\u306EAP-1\u3002\u4FEE\u7406\u3059\u308B\u306B\u306F(\u8077\u80FD:\u93A7\u935B\u51B6)\u30C6\u30B9\u30C8\u3002\u93A7\u3092\u7740\u3051\u3066\u3044\u306A\u3044\u306A\u3089\u80A1\u9593\u3078\u306E\u4E00\u6483\u30011R\u306B\u6E21\u3063\u3066\u4E00\u5207\u306E\u30A2\u30AF\u30B7\u30E7\u30F3\u3092\u884C\u306A\u3048\u306A\u3044\u3002", "05:\u8EE2\u3093\u3067\u5012\u308C\u3001\u606F\u304C\u8A70\u307E\u3063\u3066\u60B6\u7D76\u3059\u308B\u30021R\u306B\u6E21\u3063\u3066\u3042\u3089\u3086\u308B\u30C6\u30B9\u30C8\u306B-30\u306E\u4FEE\u6B63\u3001\u7ACB\u3061\u4E0A\u304C\u308B\u306B\u306F\u8D77\u7ACB\u30A2\u30AF\u30B7\u30E7\u30F3\u304C\u5FC5\u8981\u3002", "06:1d10R\u6C17\u7D76\u3002", "07:\u3072\u3069\u3044\u5185\u51FA\u8840\u304C\u8D77\u3053\u308A\u3001\u7121\u9632\u5099\u72B6\u614B\u3002\u51FA\u8840\u304C\u3072\u3069\u304F\u3001\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002", "08:\u810A\u9AC4\u304C\u7C89\u7815\u3055\u308C\u3066\u5012\u308C\u3001\u4EE5\u5F8C\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u7121\u9632\u5099\u72B6\u614B\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u3010\u9811\u5F37\u3011\u30C6\u30B9\u30C8\u306B\u5931\u6557\u3059\u308B\u3068\u8170\u304B\u3089\u4E0B\u304C\u4E0D\u968F\u306B\u306A\u308B\u3002", "09:\u51C4\u307E\u3058\u3044\u6253\u6483\u306B\u3088\u308A\u8907\u6570\u306E\u81D3\u5668\u304C\u7834\u88C2\u3057\u3001\u6B7B\u306F\u6570\u79D2\u306E\u3046\u3061\u306B\u8A2A\u308C\u308B\u3002", "10:\u6B7B\u4EA1\u3059\u308B\u3002\u3044\u304B\u306B\u76DB\u5927\u306B\u51FA\u8840\u3057\u3001\u3069\u306E\u3088\u3046\u306A\u6B7B\u306B\u69D8\u3092\u898B\u305B\u305F\u306E\u304B\u3092\u8AAC\u660E\u3057\u3066\u3082\u3088\u3044\u3002"];
      whl = ["01:\u3088\u308D\u3081\u304F\u3002\u6B21\u306E\u30BF\u30FC\u30F3\u30011\u56DE\u306E\u534A\u30A2\u30AF\u30B7\u30E7\u30F3\u3057\u304B\u884C\u306A\u3048\u306A\u3044\u3002", "02:\u811A\u304C\u75FA\u308C\u308B\u30021R\u306B\u6E21\u3063\u3066\u3010\u79FB\u52D5\u3011\u306F\u534A\u6E1B\u3057\u3001\u811A\u306B\u95A2\u9023\u3059\u308B\u3010\u654F\u6377\u3011\u30C6\u30B9\u30C8\u306B-20%\u3002\u56DE\u907F\u304C\u51FA\u6765\u306A\u304F\u306A\u308B\u3002", "03:\u811A\u306E\u6A5F\u80FD\u304C\u5931\u308F\u308C\u3001\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u56DE\u5FA9\u3057\u306A\u3044\u3002\u3010\u79FB\u52D5\u3011\u306F\u534A\u6E1B\u3057\u3001\u811A\u306B\u95A2\u9023\u3059\u308B\u3010\u654F\u6377\u3011\u30C6\u30B9\u30C8\u306B-20%\u3002\u56DE\u907F\u304C\u51FA\u6765\u306A\u304F\u306A\u308B\u3002", "04:\u93A7\u304C\u640D\u50B7\u3059\u308B\u3002\u5F53\u8A72\u90E8\u4F4D\u306EAP-1\u3002\u4FEE\u7406\u3059\u308B\u306B\u306F(\u8077\u80FD:\u93A7\u935B\u51B6)\u30C6\u30B9\u30C8\u3002\u93A7\u3092\u7740\u3051\u3066\u3044\u306A\u3044\u306A\u3089\u811A\u304C\u75FA\u308C\u308B\u30011R\u306B\u6E21\u3063\u3066\u3010\u79FB\u52D5\u3011\u306F\u534A\u6E1B\u3057\u3001\u811A\u306B\u95A2\u9023\u3059\u308B\u3010\u654F\u6377\u3011\u30C6\u30B9\u30C8\u306B-20%\u3001\u56DE\u907F\u4E0D\u53EF\u306B\u306A\u308B\u3002", "05:\u8EE2\u3093\u3067\u5012\u308C\u3001\u982D\u304C\u304F\u3089\u304F\u3089\u3059\u308B\u30021R\u306B\u6E21\u3063\u3066\u3042\u3089\u3086\u308B\u30C6\u30B9\u30C8\u306B-30\u306E\u4FEE\u6B63\u3001\u7ACB\u3061\u4E0A\u304C\u308B\u306B\u306F\u8D77\u7ACB\u30A2\u30AF\u30B7\u30E7\u30F3\u304C\u5FC5\u8981\u3002", "06:\u811A\u304C\u7815\u304B\u308C\u3001\u7121\u9632\u5099\u72B6\u614B\u3002\u51FA\u8840\u304C\u3072\u3069\u304F\u3001\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002", "07:\u811A\u306F\u8840\u307E\u307F\u308C\u306E\u6B8B\u9AB8\u3068\u5316\u3057\u3001\u7121\u9632\u5099\u72B6\u614B\u306B\u306A\u308B\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u3010\u9811\u5F37\u3011\u30C6\u30B9\u30C8\u306B\u5931\u6557\u3059\u308B\u3068\u8DB3\u9996\u304B\u3089\u5148\u3092\u5931\u3046\u3002", "08:\u811A\u306F\u8840\u307E\u307F\u308C\u306E\u8089\u584A\u304C\u3076\u3089\u3055\u304C\u3063\u3066\u3044\u308B\u72B6\u614B\u3002\u4EE5\u5F8C\u7121\u9632\u5099\u72B6\u614B\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u306E\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20%\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u3010\u9811\u5F37\u3011\u30C6\u30B9\u30C8\u306B\u5931\u6557\u3059\u308B\u3068\u819D\u304B\u3089\u4E0B\u3092\u5931\u3046\u3002", "09:\u5927\u52D5\u8108\u306B\u50B7\u304C\u53CA\u3076\u3002\u30B3\u30F3\u30DE\u6570\u79D2\u306E\u5185\u306B\u811A\u306E\u6B8B\u9AB8\u304B\u3089\u8840\u3092\u5674\u51FA\u3057\u3066\u5012\u308C\u3001\u30B7\u30E7\u30C3\u30AF\u3068\u51FA\u8840\u3067\u6B7B\u306F\u77AC\u6642\u306B\u8A2A\u308C\u308B\u3002", "10:\u6B7B\u4EA1\u3059\u308B\u3002\u3044\u304B\u306B\u76DB\u5927\u306B\u51FA\u8840\u3057\u3001\u3069\u306E\u3088\u3046\u306A\u6B7B\u306B\u69D8\u3092\u898B\u305B\u305F\u306E\u304B\u3092\u8AAC\u660E\u3057\u3066\u3082\u3088\u3044\u3002"];
      whw = ["01:\u8EFD\u6253\u30021\u30E9\u30A6\u30F3\u30C9\u306B\u6E21\u3063\u3066\u3001\u3042\u3089\u3086\u308B\u30C6\u30B9\u30C8\u306B-10\uFF05\u3002", "02:\u304B\u3059\u308A\u50B7\u3002+10\uFF05\u306E\u3010\u654F\u6377\u3011\u30C6\u30B9\u30C8\u3092\u884C\u3044\u3001\u5931\u6557\u306A\u3089\u76F4\u3061\u306B\u9AD8\u5EA6\u30921\u6BB5\u968E\u5931\u3046\u3002\u5730\u4E0A\u306B\u3044\u308B\u30AF\u30EA\u30FC\u30C1\u30E3\u30FC\u306F\u3001\u6B21\u306E\u30BF\u30FC\u30F3\u306B\u306F\u98DB\u3073\u7ACB\u3066\u306A\u3044\u3002", "03:\u640D\u50B7\u3059\u308B\u3002\u3010\u98DB\u884C\u79FB\u52D5\u529B\u3011\u304C2\u70B9\u4F4E\u4E0B\u3059\u308B\u3002-10\uFF05\u306E\u3010\u654F\u6377\u3011\u30C6\u30B9\u30C8\u3092\u884C\u3044\u3001\u5931\u6557\u306A\u3089\u76F4\u3061\u306B\u9AD8\u5EA6\u30921\u6BB5\u968E\u5931\u3046\u3002\u5730\u4E0A\u306B\u3044\u308B\u30AF\u30EA\u30FC\u30C1\u30E3\u30FC\u306F\u3001\u6B21\u306E\u30BF\u30FC\u30F3\u306B\u306F\u98DB\u3073\u7ACB\u3066\u306A\u3044\u3002", "04:\u9177\u304F\u640D\u50B7\u3059\u308B\u3002\u3010\u98DB\u884C\u79FB\u52D5\u529B\u3011\u304C4\u70B9\u4F4E\u4E0B\u3059\u308B\u3002-30\uFF05\u306E\u3010\u654F\u6377\u3011\u30C6\u30B9\u30C8\u3092\u884C\u3044\u3001\u5931\u6557\u306A\u3089\u76F4\u3061\u306B\u9AD8\u5EA6\u30921\u6BB5\u968E\u5931\u3046\u3002\u5730\u4E0A\u306B\u3044\u308B\u30AF\u30EA\u30FC\u30C1\u30E3\u30FC\u306F\u30011d10\u30BF\u30FC\u30F3\u304C\u7D4C\u904E\u3059\u308B\u307E\u3067\u98DB\u3073\u7ACB\u3066\u306A\u3044\u3002", "05:\u7FFC\u304C\u4F7F\u3048\u306A\u304F\u306A\u308B\u3002\u3010\u98DB\u884C\u79FB\u52D5\u529B\u3011\u304C0\u306B\u4F4E\u4E0B\u3059\u308B\u3002\u98DB\u884C\u4E2D\u306E\u3082\u306E\u306F\u843D\u4E0B\u3057\u3001\u9AD8\u5EA6\u306B\u5FDC\u3058\u305F\u30C0\u30E1\u30FC\u30B8\u3092\u53D7\u3051\u308B\u3002\u5730\u4E0A\u306B\u3044\u308B\u30AF\u30EA\u30FC\u30C1\u30E3\u30FC\u306F\u3001\u602A\u6211\u304C\u7652\u3048\u308B\u307E\u3067\u98DB\u3073\u7ACB\u3066\u306A\u3044\u3002", "06:\u7FFC\u306E\u4ED8\u3051\u6839\u306B\u50B7\u304C\u958B\u304F\u3002\u3010\u98DB\u884C\u79FB\u52D5\u529B\u3011\u304C0\u306B\u4F4E\u4E0B\u3059\u308B\u3002\u98DB\u884C\u4E2D\u306E\u3082\u306E\u306F\u843D\u4E0B\u3057\u3001\u9AD8\u5EA6\u306B\u5FDC\u3058\u305F\u30C0\u30E1\u30FC\u30B8\u3092\u53D7\u3051\u308B\u3002\u5730\u4E0A\u306B\u3044\u308B\u30AF\u30EA\u30FC\u30C1\u30E3\u30FC\u306F\u3001\u602A\u6211\u304C\u7652\u3048\u308B\u307E\u3067\u98DB\u3073\u7ACB\u3066\u306A\u3044\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20\uFF05\u306E\u78BA\u7387\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002", "07:\u7FFC\u306F\u8840\u307E\u307F\u308C\u306E\u6B8B\u9AB8\u3068\u5316\u3057\u3001\u7121\u9632\u5099\u72B6\u614B\u306B\u306A\u308B\u3002\u3010\u98DB\u884C\u79FB\u52D5\u529B\u3011\u304C0\u306B\u4F4E\u4E0B\u3059\u308B\u3002\u98DB\u884C\u4E2D\u306E\u3082\u306E\u306F\u843D\u4E0B\u3057\u3001\u9AD8\u5EA6\u306B\u5FDC\u3058\u305F\u30C0\u30E1\u30FC\u30B8\u3092\u53D7\u3051\u308B\u3002\u5730\u4E0A\u306B\u3044\u308B\u30AF\u30EA\u30FC\u30C1\u30E3\u30FC\u306F\u3001\u602A\u6211\u304C\u7652\u3048\u308B\u307E\u3067\u98DB\u3073\u7ACB\u3066\u306A\u3044\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20\uFF05\u306E\u78BA\u7387\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u3010\u9811\u5F37\u3011\u30C6\u30B9\u30C8\u306B\u5931\u6557\u3059\u308B\u3068\u98DB\u884C\u80FD\u529B\u3092\u5931\u3046\u3002", "08:\u7FFC\u304C\u5343\u5207\u308C\u3066\u30D0\u30E9\u30D0\u30E9\u306B\u306A\u308A\u3001\u7121\u9632\u5099\u72B6\u614B\u306B\u306A\u308B\u3002\u3010\u98DB\u884C\u79FB\u52D5\u529B\u3011\u304C0\u306B\u4F4E\u4E0B\u3059\u308B\u3002\u98DB\u884C\u4E2D\u306E\u3082\u306E\u306F\u843D\u4E0B\u3057\u3001\u9AD8\u5EA6\u306B\u5FDC\u3058\u305F\u30C0\u30E1\u30FC\u30B8\u3092\u53D7\u3051\u308B\u3002\u5730\u4E0A\u306B\u3044\u308B\u30AF\u30EA\u30FC\u30C1\u30E3\u30FC\u306F\u3001\u602A\u6211\u304C\u7652\u3048\u308B\u307E\u3067\u98DB\u3073\u7ACB\u3066\u306A\u3044\u3002\u6CBB\u7642\u3092\u53D7\u3051\u308B\u307E\u3067\u6BCER\u88AB\u5BB3\u8005\u306E\u30BF\u30FC\u30F3\u958B\u59CB\u6642\u306B20\uFF05\u306E\u78BA\u7387\u3067\u6B7B\u4EA1\u3002\u4EE5\u5F8CCT\u306F\u30B5\u30C9\u30F3\u30C7\u30B9\u3092\u9069\u7528\u3002\u98DB\u884C\u80FD\u529B\u3092\u5931\u3046\u3002", "09:\u5927\u52D5\u8108\u304C\u5207\u65AD\u3055\u308C\u305F\u3002\u30B3\u30F3\u30DE\u6570\u79D2\u306E\u5185\u306B\u8840\u3092\u5674\u304D\u4E0A\u3052\u3066\u304F\u305A\u304A\u308C\u308B\u3001\u30B7\u30E7\u30C3\u30AF\u3068\u51FA\u8840\u3067\u6B7B\u306F\u77AC\u6642\u306B\u8A2A\u308C\u308B\u3002", "10:\u6B7B\u4EA1\u3059\u308B\u3002\u3044\u304B\u306B\u76DB\u5927\u306B\u51FA\u8840\u3057\u3001\u3069\u306E\u3088\u3046\u306A\u6B7B\u306B\u69D8\u3092\u898B\u305B\u305F\u306E\u304B\u3092\u8AAC\u660E\u3057\u3066\u3082\u3088\u3044\u3002"];
      criticalTable = [5, 7, 9, 10, 10, 10, 10, 10, 10, 10, 5, 6, 8, 9, 10, 10, 10, 10, 10, 10, 4, 6, 8, 9, 9, 10, 10, 10, 10, 10, 4, 5, 7, 8, 9, 9, 10, 10, 10, 10, 3, 5, 7, 8, 8, 9, 9, 10, 10, 10, 3, 4, 6, 7, 8, 8, 9, 9, 10, 10, 2, 4, 6, 7, 7, 8, 8, 9, 9, 10, 2, 3, 5, 6, 7, 7, 8, 8, 9, 9, 1, 3, 5, 6, 6, 7, 7, 8, 8, 9, 1, 2, 4, 5, 6, 6, 7, 7, 8, 8];
      output = "1";
      if ($truthy(/WH([HABTLW])(\d+)/['$=~'](string))) {
      } else {
        return "1"
      };
      partsWord = $$($nesting, 'Regexp').$last_match(1);
      criticalValue = $$($nesting, 'Regexp').$last_match(2).$to_i();
      if ($truthy($rb_gt(criticalValue, 10))) {
        criticalValue = 10};
      if ($truthy($rb_lt(criticalValue, 1))) {
        criticalValue = 1};
      whpp = "";
      whppp = "";
      $case = partsWord;
      if (/H/i['$===']($case)) {
      whpp = "\u982D\u90E8";
      whppp = whh;}
      else if (/A/i['$===']($case)) {
      whpp = "\u8155\u90E8";
      whppp = wha;}
      else if (/[TB]/i['$===']($case)) {
      whpp = "\u80F4\u4F53";
      whppp = whb;}
      else if (/L/i['$===']($case)) {
      whpp = "\u811A\u90E8";
      whppp = whl;}
      else if (/W/i['$===']($case)) {
      whpp = "\u7FFC\u90E8";
      whppp = whw;};
      $b = self.$roll(1, 100), $a = Opal.to_ary($b), (dice_now = ($a[0] == null ? nil : $a[0])), $b;
      crit_no = $rb_times($rb_divide($rb_minus(dice_now, 1), 10).$to_i(), 10);
      crit_num = criticalTable['$[]']($rb_minus($rb_plus(crit_no, criticalValue), 1));
      resultText = whppp['$[]']($rb_minus(crit_num, 1));
      if ($truthy($rb_ge(crit_num, 5))) {
        resultText = $rb_plus(resultText, "\u30B5\u30C9\u30F3\u30C7\u30B9\u00D7")
      } else {
        resultText = $rb_plus(resultText, "\u30B5\u30C9\u30F3\u30C7\u30B9\u25CB")
      };
      output = "" + (whpp) + "CT\u8868(" + (dice_now) + "+" + (criticalValue) + ") \uFF1E " + (resultText);
      return output;
    }, $Warhammer_getCriticalResult$4.$$arity = 1);
    
    Opal.def(self, '$wh_atpos', $Warhammer_wh_atpos$5 = function $$wh_atpos(pos_num, pos_type) {
      var $$6, self = this, pos_2l = nil, pos_2lw = nil, pos_4l = nil, pos_4la = nil, pos_4lw = nil, pos_b = nil, wh_pos = nil, pos_t = nil, $case = nil, output = nil, pos_i = nil;

      
      self.$debug("wh_atpos begin pos_type", pos_type);
      pos_2l = ["\u4E8C\u8DB3", 15, "\u982D\u90E8", 35, "\u53F3\u8155", 55, "\u5DE6\u8155", 80, "\u80F4\u4F53", 90, "\u53F3\u811A", 100, "\u5DE6\u811A"];
      pos_2lw = ["\u6709\u7FFC\u4E8C\u8DB3", 15, "\u982D\u90E8", 25, "\u53F3\u8155", 35, "\u5DE6\u8155", 45, "\u53F3\u7FFC", 55, "\u5DE6\u7FFC", 80, "\u80F4\u4F53", 90, "\u53F3\u811A", 100, "\u5DE6\u811A"];
      pos_4l = ["\u56DB\u8DB3", 15, "\u982D\u90E8", 60, "\u80F4\u4F53", 70, "\u53F3\u524D\u811A", 80, "\u5DE6\u524D\u811A", 90, "\u53F3\u5F8C\u811A", 100, "\u5DE6\u5F8C\u811A"];
      pos_4la = ["\u534A\u4EBA\u56DB\u8DB3", 10, "\u982D\u90E8", 20, "\u53F3\u8155", 30, "\u5DE6\u8155", 60, "\u80F4\u4F53", 70, "\u53F3\u524D\u811A", 80, "\u5DE6\u524D\u811A", 90, "\u53F3\u5F8C\u811A", 100, "\u5DE6\u5F8C\u811A"];
      pos_4lw = ["\u6709\u7FFC\u56DB\u8DB3", 10, "\u982D\u90E8", 20, "\u53F3\u7FFC", 30, "\u5DE6\u7FFC", 60, "\u80F4\u4F53", 70, "\u53F3\u524D\u811A", 80, "\u5DE6\u524D\u811A", 90, "\u53F3\u5F8C\u811A", 100, "\u5DE6\u5F8C\u811A"];
      pos_b = ["\u9CE5", 15, "\u982D\u90E8", 35, "\u53F3\u7FFC", 55, "\u5DE6\u7FFC", 80, "\u80F4\u4F53", 90, "\u53F3\u811A", 100, "\u5DE6\u811A"];
      wh_pos = [pos_2l, pos_2lw, pos_4l, pos_4la, pos_4lw, pos_b];
      pos_t = 0;
      self.$debug("pos_type", pos_type);
      if ($truthy(pos_type['$!='](""))) {
        $case = pos_type;
        if (/\@(2W|W2)/i['$===']($case)) {pos_t = 1}
        else if (/\@(4W|W4)/i['$===']($case)) {pos_t = 4}
        else if (/\@(4H|H4)/i['$===']($case)) {pos_t = 3}
        else if (/\@4/i['$===']($case)) {pos_t = 2}
        else if (/\@W/i['$===']($case)) {pos_t = 5}
        else {if ($truthy(/\@(2H|H2|2)/i['$=~'](pos_type))) {
        } else {
          pos_t = -1
        }}};
      output = "";
      self.$debug("pos_t", pos_t);
      if ($truthy($rb_lt(pos_t, 0))) {
        $send(wh_pos, 'each', [], ($$6 = function(pos_i){var self = $$6.$$s || this;

        
          
          if (pos_i == null) {
            pos_i = nil;
          };
          return (output = $rb_plus(output, self.$get_wh_atpos_message(pos_i, pos_num)));}, $$6.$$s = self, $$6.$$arity = 1, $$6))
      } else {
        
        pos_i = wh_pos['$[]'](pos_t);
        output = $rb_plus(output, self.$get_wh_atpos_message(pos_i, pos_num));
      };
      return output;
    }, $Warhammer_wh_atpos$5.$$arity = 2);
    
    Opal.def(self, '$get_wh_atpos_message', $Warhammer_get_wh_atpos_message$7 = function $$get_wh_atpos_message(pos_i, pos_num) {
      var $$8, self = this, output = nil;

      
      output = "";
      output = $rb_plus(output, $rb_plus($rb_plus(" ", pos_i['$[]'](0)), ":"));
      (function(){var $brk = Opal.new_brk(); try {return $send((1), 'step', [$rb_plus(pos_i.$length(), 1), 2], ($$8 = function(i){var self = $$8.$$s || this;

      
        
        if (i == null) {
          i = nil;
        };
        if ($truthy($rb_le(pos_num, pos_i['$[]'](i)))) {
          
          output = $rb_plus(output, pos_i['$[]']($rb_plus(i, 1)));
          
          Opal.brk(nil, $brk);
        } else {
          return nil
        };}, $$8.$$s = self, $$8.$$brk = $brk, $$8.$$arity = 1, $$8))
      } catch (err) { if (err === $brk) { return err.$v } else { throw err } }})();
      return output;
    }, $Warhammer_get_wh_atpos_message$7.$$arity = 2);
    return (Opal.def(self, '$getAttackResult', $Warhammer_getAttackResult$9 = function $$getAttackResult(string) {
      var $a, $b, self = this, pos_type = nil, diff = nil, total_n = nil, output = nil, pos_num = nil;

      
      self.$debug("getAttackResult begin string", string);
      pos_type = "";
      if ($truthy(/(.+)(@.*)/['$=~'](string))) {
        
        string = $$($nesting, 'Regexp').$last_match(1);
        pos_type = $$($nesting, 'Regexp').$last_match(2);
        self.$debug("pos_type", pos_type);};
      if ($truthy(/WH(\d+)/i['$=~'](string))) {
      } else {
        return "1"
      };
      diff = $$($nesting, 'Regexp').$last_match(1).$to_i();
      $b = self.$roll(1, 100), $a = Opal.to_ary($b), (total_n = ($a[0] == null ? nil : $a[0])), $b;
      output = "" + "(" + (string) + ") \uFF1E " + (total_n);
      output = $rb_plus(output, self.$check_1D100(total_n, total_n, "<=", diff));
      pos_num = $rb_plus($rb_times(total_n['$%'](10), 10), $rb_divide(total_n, 10).$to_i());
      if ($truthy($rb_ge(total_n, 100))) {
        pos_num = 100};
      if ($truthy($rb_le(total_n, diff))) {
        output = $rb_plus(output, self.$wh_atpos(pos_num, pos_type))};
      return output;
    }, $Warhammer_getAttackResult$9.$$arity = 1), nil) && 'getAttackResult';
  })($nesting[0], $$($nesting, 'DiceBot'), $nesting)
})(Opal);
